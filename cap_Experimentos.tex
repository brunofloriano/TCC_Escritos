%TCIDATA{LaTeXparent=0,0,relatorio.tex}
                      
\chapter{Resultados Experimentais}\label{CapExperimentos}

% Resumo opcional. Comentar se não usar.
\resumodocapitulo{Resumo opcional.}

\section{Introdução}

%Na introdução deverá ser feita uma descrição geral dos experimentos realizados. 

%Para cada experimentação apresentada, descrever as condições de experimentação (e.g., instrumentos, ligações específicas, configurações dos programas), os resultados obtidos na forma de tabelas, curvas ou gráficos. Por fim, tão importante quando ter os resultados é a análise que se faz deles. Quando os resultados obtidos não forem como esperados, procurar justificar e/ou propor alteração na teoria de forma a justificá-los.

Como foi abordado no Capítulo \ref{CapDesenvolvimento}, o desenvolvimento do projeto sofreu modificações com relação à concepção inicial do controle de estabilidade. As principais mudanças, assim como a determinação dos coeficientes de resposta dos motores, foram baseadas em testes reais na plataforma, que serão mostrados e analisados neste capítulo.

Os experimentos consistiram na execução do programa elaborado para cada etapa do desenvolvimento do controle. A cada etapa, eram realizados experimentos com o robô nos seguintes cenários: sustentado por uma caixa, sem contato das patas com o solo; com o robô em pé se sustentando, mas sem nenhum distúrbio e sendo empurrado para a esquerda, direita, para frente ou para trás.

Após cada experimento, os dados eram recolhidos e analisados através do software \emph{Matlab}. Os gráficos que serão apresentados neste capítulo foram obtidos por tal programa.

\section{Modo Velocidade}
A primeira abordagem do controle de estabilidade foi a utilização dos motores no modo velocidade. Nesta seção serão apresentados os principais resultados obtidos neste modo de operação e analisadas as suas consequências para o controle de estabilidade.

\subsection{Medição}
O primeiro elemento a ser testado é a medição dos ângulos pelo acelerômetro. Além disso, pode-se obter a velocidade dos ângulos de rolagem e arfagem através da derivação e observar os efeitos do filtro passa-baixa desenvolvido.

O teste é feito com o robô parado, sustentado por uma caixa que impede as patas de entrarem em contato com o solo, sem a adição de qualquer distúrbio e com a resposta dos motores desativada. Dessa forma, é possível observar o ruído produzido durante a medição, uma vez que os dados de velocidade, em um cenário ideal, deveriam ser iguais a zero e os ângulos, sempre constantes. Podemos observar a medição destes na Figura \ref{fig:angulos_ruido}.

\begin{figure} [tb]
	\centering
	\includegraphics[width=0.7\textwidth]{Figuras/Angulos_ruido}
	\caption{Ângulos de Rolagem e Arfagem medidos com o robô parado}
	\label{fig:angulos_ruido}
\end{figure}

Os ângulos iniciam o teste com os valores iniciais de zero graus, devido à inicialização da conexão com o \emph{Arduino}. No entanto, após 6 períodos de amostragem (ou 1.2 segundos) a aquisição de dados é estabelecida. A partir de então, podemos notar que os dados sofrem variações devido ao ruído. Utilizando os comandos \emph{max}, \emph{min} e \emph{mean} do \emph{Matlab} podemos identificar os ângulos mínimo, máximo e médio atingidos para cada medição. Tais valores são apresentados na Tabela \ref{TabAngulos}. 

\begin{table}[b]
	\caption{Ângulos mínimo, máximo e médio medidos}
	\label{TabAngulos}
	\begin{center}
		\begin{tabular}{|c|c|c|c|}
			\hline
			\textbf{Orientação} & \textbf{Valor mínimo (graus)} & \textbf{Valor máximo (graus)} & \textbf{Valor médio (graus)} \\
			\hline
			Rolagem & 0.6663 & 1.3429 & 0.9947\\
			Arfagem & -0.3531 & 0.3237 & -0.0849\\ \hline
		\end{tabular}
	\end{center}
\end{table}

Podemos observar que o valor médio das duas quantidades é diferente de zero, apesar de muito próximos deste valor, indicando uma pequena inclinação da superfície em que o robô é instalado. A variação de cada ângulo medido a cada período de amostragem é um efeito do ruído de medição, caracterizado por altas frequências.

Após a medição, os ângulos são derivados e, em seguida, passados por um filtro passa-baixa, especificado pela equação \ref{eq:filtro}. As velocidades resultantes após a derivação e após a filtragem podem ser visualizadas na Figura \ref{fig:velocidades_medidas}. Para poder analisar o efeito do filtro sobre a velocidade calculada, montou-se a Tabela \ref{TabVelocidades}. Nela foram organizados os valores mínimo, máximo e médio das velocidades assim como sua amplitude, ou seja, a diferença entre o máximo e o mínimo atingidos.

\begin{figure}[tb]
	\centering
	\mbox{
		\subfigure[Velocidade de Rolagem]{\includegraphics[width=0.5\textwidth]{Figuras/Filtro_roll}}\quad\quad
		\subfigure[Velocidade de Arfagem]{\includegraphics[width=0.5\textwidth]{Figuras/Filtro_pitch}}}
	\caption{Velocidades antes e depois da filtragem}
	\label{fig:velocidades_medidas}
\end{figure}

Dessa forma, podemos observar que, com a inclusão do filtro, a amplitude do ruído decaiu 45.7\% para a medição da velocidade de rolagem e 52.5\% para a arfagem. Isso indica que o efeito do filtro sob a medição da velocidade se mostrou adequado para as necessidades para as quais ele foi desenvolvido. Isto é, ele é capaz de amenizar a ação do ruído em altas frequências.

\begin{table}[b]
	\caption{Velocidades mínima, máxima, média e sua amplitude}
	\label{TabVelocidades}
	\begin{center}
		\begin{tabular}{c|c|c|c|c}
			\hline
			\textbf{Orientação} & \textbf{Mínimo (rad/s)} & \textbf{Máximo (rad/s)} & \textbf{Amplitude (rad/s)} & \textbf{Média (rad/s)} \\
			\hline
			Rolagem & -0.0581 & 0.1172 & 0.1753 & $7.0738*10^{-4}$\\
			Rolagem filtrada & -0.0299 & 0.0952 & 0.0653 & $7.0598*10^{-4}$\\
			Arfagem & -0.0399 & 0.0409 & 0.0808 & $8.3171*10^{-5}$\\
			Arfagem filtrada & -0.0184 & 0.0384 & 0.02 & $2.9474*10^{-5}$\\ \hline
		\end{tabular}
	\end{center}
\end{table}

Por fim, pode-se observar que o valor médio das velocidades obtidas encontra-se na ordem de $10^{-4}$ e $10^{-5}$ e, dessa forma, reduzidos o bastante para serem considerados próximos de zero. Como será visto mais adiante, um distúrbio no sentido de rolagem, por exemplo, permanece na ordem de $10^{0}$ e $10^{1}$ rad/s.

\subsection{Teste de Sustentação} \label{sec:sustentacao_velocidade}
Com as medições realizadas, os procedimentos seguintes envolvem o robô parado, sustentado pelas suas próprias patas e sem a aplicação de nenhum distúrbio externo. Para tal, o sistema implementado, inicialmente, impõe as posições iniciais de cada motor de modo que o robô fique na postura adequada. Em seguida, a plataforma é posicionada no solo e nenhum distúrbio (e.g. empurrão) é aplicado. Este experimento foi realizado, para fins de comparação, tanto para o controle desenvolvido para o modo velocidade, caracterizado pela equação \ref{eq:controle_velocidade_discreto}, como para o controle adaptado para o modo posição, determinado pela equação \ref{eq:controle_posicao_discreto}.

O resultado obtido no modo velocidade pode ser visualizado pela Figura \ref{fig:teste_sustentacao}. Na Fig. \ref{fig:teste_sustentacao}(a) são mostrados os ângulos de rolagem e arfagem medidos. Já a Fig. \ref{fig:teste_sustentacao}(b) apresenta, em vermelho, a velocidade de rolagem e, de amarelo, a velocidade dos motores utilizados para corrigir o distúrbio nesta direção (i.e. motores 1, 4, 7 e 10). Analogamente, a Fig. \ref{fig:teste_sustentacao}(b) contém a velocidade de arfagem e dos respectivos motores que a corrigem.

\begin{figure}[b]
	%\centering
	\mbox{
		\subfigure[Ângulos medidos]{\includegraphics[width=0.3\textwidth]{Figuras/Modo_velocidade1}}\quad\quad
		\subfigure[Velocidade de Rolagem e dos seus motores]{\includegraphics[width=0.3\textwidth]{Figuras/Modo_velocidade2}}
		\subfigure[Velocidade de Arfagem e dos seus motores]{\includegraphics[width=0.3\textwidth]{Figuras/Modo_velocidade3}}}
	\caption{Teste de Sustentação do Robô}
	\label{fig:teste_sustentacao}
\end{figure}

Podemos notar, uma grande movimentação entre os instantes 1 e 3 segundos mas que se devem apenas à alocação do robô sobre o solo. A partir deste momento, nenhum distúrbio externo foi aplicado ao robô. Ainda assim, é possível observar, na Fig. \ref{fig:teste_sustentacao}(a), que o robô sofre uma queda, a partir de aproximadamente 8 segundos, quando o ângulo de arfagem caiu para -18.3127 graus.

Para analisar o ocorrido podemos verificar a Fig. \ref{fig:teste_sustentacao}(c), representando a direção em que houve a queda (i.e arfagem). Nela, as linhas em amarelo, representando as velocidades dos motores, começam a aumentar (em módulo) alguns segundos antes da queda brusca. Este é um indicador de que as juntas começaram a ceder inicialmente de forma lenta e foram aumentando sua velocidade até que o robô não foi mais capaz de se sustentar, gerando a queda.

Podemos, para melhor visualização, separar a resposta de um desses motores, como é feito na Figura \ref{fig:motor_queda}. Nesta imagem, isolou-se a resposta, em módulo, do motor 11 (utilizado para corrigir a arfagem em uma junta do tipo não joelho). Constata-se que a velocidade do motor começou a aumentar cerca de 2 segundos antes da queda do robô, atingindo o seu ápice por volta de 8.42 segundos.

\begin{figure} [tb]
	\centering
	\includegraphics[width=0.7\textwidth]{Figuras/Modo_velocidade4}
	\caption{Velocidade do Motor 11}
	\label{fig:motor_queda}
\end{figure}

Como não houve distúrbios externos e a resposta dos motores havia sido configurada para 0 rad/s, conclui-se que os motores não apresentam torque suficiente no modo velocidade para manter a velocidade como tal e, consequentemente, deixam as juntas suscetíveis a serem movimentadas. Isto ocasionou que o peso do robô movimentou as juntas até o ponto que o robô não foi capaz de sustentar mais.

Como será visto na próxima seção, o modo posição apresenta um torque bastante elevado quando comparado ao modo velocidade. Neste caso, ao determinar uma posição para o motor (assim como configuramos uma velocidade de 0 rad/s) este fixa tal localização e não cede facilmente a movimentos externos que tendam a mover a junta para uma posição diferente. Portanto, é mais vantajoso que trabalhemos no modo posição para que o robô possa se sustentar sozinho.

\section{Modo Posição}
Com o modo posição, podemos utilizar os motores de forma mais adequada para que o robô se sustente e corrija os distúrbios aos quais está suscetível. Da mesma forma que no modo velocidade, nesta seção abordar-se-a os resultados atingidos com os experimentos no modo posição analisando o que necessita de modificação e, principalmente, obtendo os dados empíricos para a determinação das constantes de controle.

\subsection{Teste de Sustentação}
Assim como foi realizado na seção \ref{sec:sustentacao_velocidade}, neste experimento realizou-se o teste de sustentação, com o robô em pé, parado, sem aplicação de distúrbios externos e com a velocidade dos motores configurada para zero. A diferença entre o presente experimento e o item mencionado é que, neste caso, para manter a velocidade de 0 rad/s em cada motor, o sistema configura sua posição sempre com o mesmo valor enquanto, anteriormente, a própria velocidade era configurada.

Os dados obtidos para tal teste podem ser analisados na Figura \ref{fig:teste_sustentacao_posicao}. Podemos observar que o experimento foi possível de ser realizado por mais tempo que anteriormente pois não houve a queda do robô. Dessa forma, as figuras apresentadas apresentam apenas ruído, uma vez que não 

\begin{figure}[t]
	%\centering
	\mbox{
		\subfigure[Ângulos medidos]{\includegraphics[width=0.3\textwidth]{Figuras/Modo_posicao1}}\quad\quad
		\subfigure[Velocidade de Rolagem e dos seus motores]{\includegraphics[width=0.3\textwidth]{Figuras/Modo_posicao2}}
		\subfigure[Velocidade de Arfagem e dos seus motores]{\includegraphics[width=0.3\textwidth]{Figuras/Modo_posicao3}}}
	\caption{Teste de Sustentação do Robô no Modo Posição}
	\label{fig:teste_sustentacao_posicao}
\end{figure}